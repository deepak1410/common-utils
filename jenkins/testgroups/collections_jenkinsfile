pipeline {
  agent any
  stages {

    stage("Build") {
      steps() {
        sh "mvn clean package -B -DskipTests"
      }
    }

    stage("Test") {
      steps() {
        script {
            try {
                sh "mvn test -Dtest=com.dpk.list.**.*Test,com.dpk.set.**.*Test"
            } catch (exc) {
                echo "Some test failed, the pipeline will fail."
                currentBuild.result = 'UNSTABLE'
            }
        }

      }
      post {
        always {
          junit "target/surefire-reports/*.xml"
        }
      }
    }

  }
}